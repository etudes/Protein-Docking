c
      SUBROUTINE xhp_window(U1,P1,P2,USIZEX,PSIZE)
c
C ---	DEFINE PLOT WINDOW AND SCALE CONSTANTS
C ---	U1 IS USER SPACE LOWER LEFT CORNER
C ---	P1 IS PLOT SPACE LOWER LEFT CORNER
C ---	P2 IS PLOT SPACE UPPER RIGHT CORNER
C ---	USIZEX USER SIZES IN X
C ---	PSIZE PLOT SIZE IN X
C
      include 'xhp_graf.incl'
c
      real U1(2),usizex
c
      INTEGER P1(2),P2(2),PSIZE
C
      BYTE P(3)
c
! mrh
      character*1 P_c(3)
      equivalence(P,P_c)
c
      DATA P_c/'I','W',';'/
C
      IF(P1(1).LE.    0)GOTO 101
  202 IF(P1(1).GE.16000)GOTO 102
  203 IF(P1(2).LE.    0)GOTO 103
  204 IF(P1(2).GE.11400)GOTO 104
C
C ---	THAT SHOULD CHECK LOWER LEFT FOR ERRORS
C ---	NOW DEFINE USER TO PLOT COORDINATE SCALING
c
  205 XSCALE(1)=PSIZE/USIZEX
      YSCALE(1)=XSCALE(1)
      XSCALE(2)=P1(1)-U1(1)*XSCALE(1)
      YSCALE(2)=P1(2)-U1(2)*YSCALE(1)
C
C ---	CHECK IF P2 LEGAL
c
      IF(P2(1).LE.    0)GOTO 301
  402 IF(P2(1).GE.16000)GOTO 302
  403 IF(P2(2).LE.    0)GOTO 303
  404 IF(P2(2).GE.11400)GOTO 304
  405 WRITE(LUN,10)P(1),P(2),P1,P2,P(3)
      RETURN
C ---	ERROR CONDITIONS
  101 P1(1)=1
      GOTO 202
  102 P1(1)=15999
      GOTO 203
  103 P1(2)=1
      GOTO 204
  104 P1(2)=11399
      GOTO 205
  301 P2(1)=1
      GOTO 402
  302 P2(1)=15999
      GOTO 403
  303 P2(2)=1
      GOTO 404
  304 P2(2)=11399
      GOTO 405
C
  10  FORMAT(1X,2A1,4I6,A1)
c
      END
